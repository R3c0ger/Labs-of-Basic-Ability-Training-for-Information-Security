# 实验1-6实验报告

## 实验一

### 实验目的

搭建 DVWA 靶机环境。

### 实验过程

1. 配置代理，使用 NAT 模式，安装 proxychains 并配置。
2. 下载 DVWA 到本地：输入 `proxychains git clone https://github.com/digininja/DVWA.git`，再输入 `sudo mv DVWA /var/www/html` 移动到相应文件夹中。
3. 开启 apache2 服务： `sudo service apache2 start`
4. 拷贝配置文件：`cp config/config.inc.php.dist config/config.inc.php`

![](img/Pasted%20image%2020230415171348.png)

5. 开启数据库：`service mariadb start`
6. 配置数据库，在 root 用户下创建用户，验证创建成功。

![](img/Pasted%20image%2020230415175345.png)

7. 在最新版本（8.2）中开启 PHP function allow_url_include、安装 php-gd 模块、设置文件夹的写权限、在 dvwa/config/config.inc.php 中设置 reCAPTCHA key。

![](img/Pasted%20image%2020230415194645.png)

8. 在 security.php 中设置安全等级，在此设置为 Low。

## 实验二

### 实验目的

> 请求方式：HTTP 请求方法, HTTP/1.1协议中共定义了八种方法（也叫动作）来以不同方式操作指定的资源。

使用某一请求方法对某网页请求以得到 flag。了解 HTTP 的八种请求方法；学习 curl、Burp Suite 的使用方法。

### 实验过程

HTTP/1.1协议的八种请求方法为：`GET`、`HEAD`、`POST`、`PUT`、`DELETE`、`CONNECT`、`OPTIONS`、`TRACE`。可以使用 `curl -X` 指定请求方法。

#### 1. curl 方法

启动环境，打开给出的网页链接，发现网页内容如下：

![](img/Pasted%20image%2020230422103912.png)

可以看到，网页提示使用 `CTF**B` 方法，而非上述八种方法的任何一种。若提示 `HTTP Method Not Allowed` 错误，需要请求 `index.php`。可以很明显地猜出，该方法是 `CTFHUB` 方法。

在终端输入 `curl -X CTFHUB http://challenge-4c545ef0343a22ef.sandbox.ctfhub.com:10800`，结果如下：

![](img/Pasted%20image%2020230422103957.png)

可以看到，返回了错误命令 `405 Not Allowed`，因此我们需要请求 `index.php`。使用 `curl -X CTFHUB http://challenge-4c545ef0343a22ef.sandbox.ctfhub.com:10800/index.php`，结果如下：

![](img/Pasted%20image%2020230422104115.png)

得到 flag：`ctfhub{e84096dc8207f72c5bf5d28b}`

#### 2. 抓包方法

使用 Burp 抓取请求包，发送到 Repeater 之后，修改请求方法为 `CTFHUB`，再重新请求，得到 flag：`ctfhub{3f0a1e15bc79949eceb40623}`。（重开环境了）

![](img/Pasted%20image%2020230427004511.png)

![](img/Pasted%20image%2020230427004629.png)

![](img/Pasted%20image%2020230427004614.png)

## 实验三

### 实验目的

> 302跳转：HTTP 临时重定向

分析网页发生的重定向，规避重定向并获取 Flag。了解 HTTP 消息、状态码、重定向；学习 curl、Burp Suite 的使用方法。

### 实验过程

#### 1. 理论学习

HTTP 消息分为请求 Request 和响应 Response。请求报文包括以下格式：请求行 Request line、请求报头 Request header、消息正文 body；响应报文包含：响应行 Response line、响应报头 Response header、消息正文 body。

在响应行中包含状态码 Status code。1 开头的状态码表示请求已被接受，需继续处理，这类响应是临时响应；2 开头表示请求已被服务器成功接收；3 开头表示重定向，客户端须采取更多操作来实现请求；4 开头表示客户端出现错误；5 开头表示服务器出现错误。

HTTP 重定向（redirect）操作由服务器向请求发送特殊的重定向响应而触发，该响应中包含着 3 开头的状态码，和保存重定向 URL 的 Location 标头。浏览器接收到重定向响应后，立刻加载 Location 标头中的新 URL。重定向包含永久重定向、临时重定向、特殊重定向，其中 302 状态码属于临时重定向，表示由于不可预见的原因请求的页面暂不可用。

#### 2. curl 方法

启动环境，访问链接，在该网站中点击 [Give me Flag](http://challenge-aab9d63d9632bf8b.sandbox.ctfhub.com:10800/index.php) 链接，发现没有反应，根据题目推测发生了 302 重定向。

![](img/Pasted%20image%2020230426192321.png)

打开开发者模式，选择“网络”，再次点击链接，发现确实发生了 302 重定向。查看响应头，发现重定向到 `/index.html`，即为当前打开的 URL，如图所示：

![](img/Pasted%20image%2020230426192629.png)

`-i` 可以打印出响应报头。`-L` 可以让请求跟随重定向，而 curl 默认不跟随重定向。使用 curl 直接请求 [Give me Flag](http://challenge-aab9d63d9632bf8b.sandbox.ctfhub.com:10800/index.php)（即 `/index.php`）而不加 `-L` 参数 ，可得到 Flag：
`ctfhub{9234a08cb18828605359a3db}`

![](img/Pasted%20image%2020230426193048.png)

#### 3. 抓包方法

使用 Burp 抓取请求包，发送到 Repeater 之后，修改 URN 为 `/index.php`，再重新请求，得到 flag：`ctfhub{0e41b55522fbb7b454eed21b}`。（重开环境了）

![](img/Pasted%20image%2020230427002840.png)

![](img/Pasted%20image%2020230427002851.png)

![](img/Pasted%20image%2020230427003001.png)

## 实验四

### 实验目的

Cookie

### 实验过程

#### 1. 理论学习



#### 2. curl 方法



#### 3. 抓包方法



## 实验五

### 实验目的

基础认证

### 实验过程

#### 1. 理论学习



#### 2. curl 方法



#### 3. 抓包方法



## 实验六

### 实验目的

响应包源代码

### 实验过程

#### 1. 理论学习



#### 2. curl 方法



#### 3. 抓包方法



